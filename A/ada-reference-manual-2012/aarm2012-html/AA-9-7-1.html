<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Selective Accept</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.2em; margin-bottom: 0.6em}
    DIV.Indented1 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.2em; margin-bottom: 0.6em}
    DIV.NotesHeader {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 3.7em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 3.4em; margin-bottom: 0.6em}
    DIV.Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    DIV.Indented2Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 5.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Indented2Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 5.2em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><B><SPAN Style="font-size:200%; color: rgb(0,51,153)">Annotated</SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)">&nbsp;Ada Reference Manual</SPAN></B> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-7.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-7-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>9.7.1 Selective Accept</H1>
<div class="paranum">1</div>
<div class="Normal">[This form of the <SPAN Class="swiss"><A HREF="AA-9-7.html#S0230">select_statement</A></SPAN> 
allows a combination of waiting for, and selecting from, one or more 
alternatives. The selection may depend on conditions associated with 
each alternative of the <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0231">selective_accept</A></SPAN>. 
<A NAME="I4531"></A>]</div>

<H4 Class="centered">Syntax</H4>
<div class="paranum">2</div>
<div class="Indented1"><SPAN Class="swiss">selective_accept</SPAN><A NAME="I4532"></A><A NAME="S0231"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><BR>
&nbsp;&nbsp;<B>select</B><BR>
&nbsp;&nbsp;&nbsp;[<A NAME="I4533"></A><SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0232">guard</A></SPAN>]<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A NAME="I4534"></A><SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0233">select_alternative</A></SPAN><BR>
{&nbsp;<B>or</B><BR>
&nbsp;&nbsp;&nbsp;[<A NAME="I4535"></A><SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0232">guard</A></SPAN>]<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A NAME="I4536"></A><SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0233">select_alternative</A></SPAN>&nbsp;}<BR>
[&nbsp;<B>else</B><BR>
&nbsp;&nbsp;&nbsp;<A NAME="I4537"></A><SPAN Class="swiss"><A HREF="AA-5-1.html#S0145">sequence_of_statements</A></SPAN>&nbsp;]<BR>
&nbsp;&nbsp;<B>end&nbsp;select</B>;</div>
<div class="paranum">3</div>
<div class="Indented1"><SPAN Class="swiss">guard</SPAN><A NAME="I4538"></A><A NAME="S0232"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><B>when</B>&nbsp;<A NAME="I4539"></A><SPAN Class="swiss"><A HREF="AA-4-5-7.html#S0135">condition</A></SPAN>&nbsp;=&gt;</div>
<div class="paranum">4</div>
<div class="Indented1"><SPAN Class="swiss">select_alternative</SPAN><A NAME="I4540"></A><A NAME="S0233"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><BR>
&nbsp;&nbsp;&nbsp;<A NAME="I4541"></A><SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0234">accept_alternative</A></SPAN><BR>
&nbsp;&nbsp;|&nbsp;<A NAME="I4542"></A><SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN><BR>
&nbsp;&nbsp;|&nbsp;<A NAME="I4543"></A><SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0236">terminate_alternative</A></SPAN></div>
<div class="paranum">5</div>
<div class="Indented1"><SPAN Class="swiss">accept_alternative</SPAN><A NAME="I4544"></A><A NAME="S0234"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><BR>
&nbsp;&nbsp;<A NAME="I4545"></A><SPAN Class="swiss"><A HREF="AA-9-5-2.html#S0219">accept_statement</A></SPAN>&nbsp;[<A NAME="I4546"></A><SPAN Class="swiss"><A HREF="AA-5-1.html#S0145">sequence_of_statements</A></SPAN>]</div>
<div class="paranum">6</div>
<div class="Indented1"><SPAN Class="swiss">delay_alternative</SPAN><A NAME="I4547"></A><A NAME="S0235"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><BR>
&nbsp;&nbsp;<A NAME="I4548"></A><SPAN Class="swiss"><A HREF="AA-9-6.html#S0227">delay_statement</A></SPAN>&nbsp;[<A NAME="I4549"></A><SPAN Class="swiss"><A HREF="AA-5-1.html#S0145">sequence_of_statements</A></SPAN>]</div>
<div class="paranum">7</div>
<div class="Indented1"><SPAN Class="swiss">terminate_alternative</SPAN><A NAME="I4550"></A><A NAME="S0236"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><B>terminate</B>;</div>
<div class="paranum">8</div>
<div class="Indented1" style="margin-bottom: 0.4em">A <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0231">selective_accept</A></SPAN> 
shall contain at least one <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0234">accept_alternative</A></SPAN>. 
In addition, it can contain:&nbsp;</div>
<div class="paranum">9</div>
<div class="Indented2Bulleted">a <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0236">terminate_alternative</A></SPAN> 
(only one); or</div>
<div class="paranum">10</div>
<div class="Indented2Bulleted">one or more <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN>s; 
or</div>
<div class="paranum">11</div>
<div class="Indented2Bulleted"><A NAME="I4551"></A>an <I>else part</I> 
(the reserved word <B>else</B> followed by a <SPAN Class="swiss"><A HREF="AA-5-1.html#S0145">sequence_of_statements</A></SPAN>). 
</div>
<div class="paranum">12</div>
<div class="Indented1">These three possibilities are mutually exclusive. 
</div>

<H4 Class="centered">Legality Rules</H4>
<div class="paranum">13</div>
<div class="Normal">If a <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0231">selective_accept</A></SPAN> 
contains more than one <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN>, 
then all shall be <SPAN Class="swiss"><A HREF="AA-9-6.html#S0229">delay_relative_statement</A></SPAN>s, 
or all shall be <SPAN Class="swiss"><A HREF="AA-9-6.html#S0228">delay_until_statement</A></SPAN>s 
for the same time type.&nbsp;</div>
<div class="paranum">13.a</div>
<div class="Annotations"><B>Reason:&nbsp;</B>This simplifies the implementation 
and the description of the semantics.&nbsp;</div>

<H4 Class="centered">Dynamic Semantics</H4>
<div class="paranum">14</div>
<div class="Normal"><A NAME="I4552"></A>A <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0233">select_alternative</A></SPAN> 
is said to be <I>open</I> if it is not immediately preceded by a <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0232">guard</A></SPAN>, 
or if the <SPAN Class="swiss"><A HREF="AA-4-5-7.html#S0135">condition</A></SPAN> 
of its <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0232">guard</A></SPAN> 
evaluates to True. It is said to be <I>closed</I> otherwise.</div>
<div class="paranum">15</div>
<div class="Normal"><A NAME="I4553"></A>For the execution of a <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0231">selective_accept</A></SPAN>, 
any <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0232">guard</A></SPAN> 
<SPAN Class="swiss"><A HREF="AA-4-5-7.html#S0135">condition</A></SPAN>s 
are evaluated; open alternatives are thus determined. For an open <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN>, 
the <I>delay_</I><SPAN Class="swiss"><A HREF="AA-4-4.html#S0117">expression</A></SPAN> 
is also evaluated. Similarly, for an open <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0234">accept_alternative</A></SPAN> 
for an entry of a family, the <SPAN Class="swiss"><A HREF="AA-9-5-2.html#S0220">entry_index</A></SPAN> 
is also evaluated. These evaluations are performed in an arbitrary order, 
except that a <I>delay_</I><SPAN Class="swiss"><A HREF="AA-4-4.html#S0117">expression</A></SPAN> 
or <SPAN Class="swiss"><A HREF="AA-9-5-2.html#S0220">entry_index</A></SPAN> 
is not evaluated until after evaluating the corresponding <SPAN Class="swiss"><A HREF="AA-4-5-7.html#S0135">condition</A></SPAN>, 
if any. Selection and execution of one open alternative, or of the else 
part, then completes the execution of the <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0231">selective_accept</A></SPAN>; 
the rules for this selection are described below.<A NAME="I4554"></A></div>
<div class="paranum">16</div>
<div class="Normal">Open <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0234">accept_alternative</A></SPAN>s 
are first considered. Selection of one such alternative takes place immediately 
if the corresponding entry already has queued calls. If several alternatives 
can thus be selected, one of them is selected according to the entry 
queuing policy in effect (see <A HREF="AA-9-5-3.html">9.5.3</A> and <A HREF="AA-D-4.html">D.4</A>). 
When such an alternative is selected, the selected call is removed from 
its entry queue and the <SPAN Class="swiss"><A HREF="AA-11-2.html#S0265">handled_sequence_of_statements</A></SPAN> 
(if any) of the corresponding <SPAN Class="swiss"><A HREF="AA-9-5-2.html#S0219">accept_statement</A></SPAN> 
is executed; after the rendezvous completes any subsequent <SPAN Class="swiss"><A HREF="AA-5-1.html#S0145">sequence_of_statements</A></SPAN> 
of the alternative is executed. <A NAME="I4555"></A>If no selection is 
immediately possible (in the above sense) and there is no else part, 
the task blocks until an open alternative can be selected.</div>
<div class="paranum">17</div>
<div class="Normal" style="margin-bottom: 0.4em">Selection of the other 
forms of alternative or of an else part is performed as follows:&nbsp;</div>
<div class="paranum">18</div>
<div class="Bulleted">An open <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN> 
is selected when its expiration time is reached if no <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0234">accept_alternative</A></SPAN> 
or other <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN> 
can be selected prior to the expiration time. If several <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN>s 
have this same expiration time, one of them is selected according to 
the queuing policy in effect (see <A HREF="AA-D-4.html">D.4</A>); the 
default queuing policy chooses arbitrarily among the <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN>s 
whose expiration time has passed.</div>
<div class="paranum">19</div>
<div class="Bulleted">The else part is selected and its <SPAN Class="swiss"><A HREF="AA-5-1.html#S0145">sequence_of_statements</A></SPAN> 
is executed if no <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0234">accept_alternative</A></SPAN> 
can immediately be selected; in particular, if all alternatives are closed.</div>
<div class="paranum">20</div>
<div class="Bulleted">An open <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0236">terminate_alternative</A></SPAN> 
is selected if the conditions stated at the end of clause <A HREF="AA-9-3.html">9.3</A> 
are satisfied.&nbsp;</div>
<div class="paranum">20.a</div>
<div class="Annotations"><B>Ramification:&nbsp;</B>In the absence of a <SPAN Class="swiss"><A HREF="AA-9-5-4.html#S0226">requeue_statement</A></SPAN>, 
the conditions stated are such that a <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0236">terminate_alternative</A></SPAN> 
cannot be selected while there is a queued entry call for any entry of 
the task. In the presence of requeues from a task to one of its subtasks, 
it is possible that when a <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0236">terminate_alternative</A></SPAN> 
of the subtask is selected, requeued calls (for closed entries only) 
might still be queued on some entry of the subtask. Tasking_Error will 
be propagated to such callers, as is usual when a task completes while 
queued callers remain.&nbsp;</div>
<div class="paranum">21</div>
<div class="Normal"><A NAME="I4556"></A>The exception Program_Error is 
raised if all alternatives are closed and there is no else part.</div>
<div class="NotesHeader">NOTES</div>
<div class="paranum">22</div>
<div class="Notes">40&nbsp;&nbsp;A <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0231">selective_accept</A></SPAN> 
is allowed to have several open <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0235">delay_alternative</A></SPAN>s. 
A <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0231">selective_accept</A></SPAN> 
is allowed to have several open <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0234">accept_alternative</A></SPAN>s 
for the same entry.</div>

<H4 Class="centered">Examples</H4>
<div class="paranum">23</div>
<div class="Normal" style="margin-bottom: 0.4em"><I>Example of a task 
body with a selective accept:</I>&nbsp;</div>
<div class="paranum">24</div>
<div class="Examples"><B>task</B>&nbsp;<B>body</B>&nbsp;Server&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;Current_Work_Item&nbsp;:&nbsp;Work_Item;<BR>
<B>begin</B><BR>
&nbsp;&nbsp;&nbsp;<B>loop</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>select</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>accept</B>&nbsp;Next_Work_Item(WI&nbsp;:&nbsp;<B>in</B>&nbsp;Work_Item)&nbsp;<B>do</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Current_Work_Item&nbsp;:=&nbsp;WI;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>end</B>;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Process_Work_Item(Current_Work_Item);<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>or</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>accept</B>&nbsp;Shut_Down;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>exit</B>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;Premature&nbsp;shut&nbsp;down&nbsp;requested</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>or</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>terminate</B>;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;Normal&nbsp;shutdown&nbsp;at&nbsp;end&nbsp;of&nbsp;scope</I></SPAN><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>end</B>&nbsp;<B>select</B>;<BR>
&nbsp;&nbsp;&nbsp;<B>end</B>&nbsp;<B>loop</B>;<BR>
<B>end</B>&nbsp;Server;</div>

<H4 Class="centered">Wording Changes from Ada 83</H4>
<div class="paranum">24.a</div>
<div class="Annotations">The name of <SPAN Class="swiss">selective_wait</SPAN> 
was changed to <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0231">selective_accept</A></SPAN> 
to better describe what is being waited for. We kept <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0233">select_alternative</A></SPAN> 
as is, because <SPAN Class="swiss">selective_accept_alternative</SPAN> 
was too easily confused with <SPAN Class="swiss"><A HREF="AA-9-7-1.html#S0234">accept_alternative</A></SPAN>. 
</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-7.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-9-7-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
